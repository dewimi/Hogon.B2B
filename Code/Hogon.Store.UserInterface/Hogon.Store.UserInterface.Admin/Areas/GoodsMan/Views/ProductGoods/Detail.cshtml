@{
    ViewBag.Title = "Detail";
    Layout = "~/Views/Shared/_DetailLayout.cshtml";
}

<style type="text/css">
    th {
        text-align: center;
    }

    tr {
    }

    td {
        text-align: center;
    }
</style>
<div class="form-group">
    <div class="basic">

        <div class="gray-bg">
            <div class="wrapper wrapper-content animated fadeInRight">
                @*产品信息*@
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>产品信息</h5>
                            </div>
                            <div class="ibox-content form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">产品名称：</label>
                                    <div class="col-sm-7">
                                        <span id="ProductName"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">产品编码：</label>
                                    <div class="col-sm-7">
                                        <span id="ProductCode"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">品牌：</label>
                                    <div class="col-sm-7">
                                        <span id="Brand"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">搜索关键词：</label>
                                    <div class="col-sm-7">
                                        <span id="SearchPrimaryKey"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">产品类型：</label>
                                    <div class="col-sm-7">
                                        <span id="ProductType"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">最低销售价：</label>
                                    <div class="col-sm-7">
                                        <span id="SalerMinPrice"> </span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">销售基准价：</label>
                                    <div class="col-sm-7">
                                        <span id="SalerBasicPrice"> </span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">产品描述：</label>
                                    <div class="col-sm-7">
                                        <span id="ProductDescription"> </span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">促销是否影响最低价：</label>
                                    <div class="col-sm-7">
                                        <span id="IsEffectMinPrice"> </span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">是否开启最低价预警：</label>
                                    <div class="col-sm-7">
                                        <span id="IsEnableMinPriceWarning"> </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*规格*@
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox-title">
                            <h5>商品设置</h5>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>规格类型<input type="hidden" id="SpecProductTypeId"></h5>
                                    </div>
                                    <div class="ibox-content" style="height: 240px;overflow-y:auto; ">
                                        <span class="row" id="SpecType"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>规格参数</h5>
                                    </div>
                                    <div class="ibox-content" style="height: 240px;">
                                        <span id="SpecParameter"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*商品*@
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>商品列表</h5>
                    </div>
                    <div class="ibox-content" style="padding-top:20px;">
                        <table class="table table-responsive table-striped table-bordered table-hover ">
                            <thead>
                                <tr>
                                    <th>商品名称</th>
                                    <th>商品类型</th>
                                    <th>规格参数</th>
                                    <th>上架</th>
                                    <th>默认商品</th>
                                    <th>商品编码</th>
                                    <th>商品别名</th>
                                    <th>销售价</th>
                                    <th>商品重量(kg)</th>
                                </tr>
                            </thead>
                            <tbody id="ProductGoods"></tbody>
                        </table>
                    </div>
                </div>
                @*应用案例*@
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>应用案例</h5>
                    </div>
                    <div class="ibox-content">
                        <table class="table table-responsive table-striped table-bordered table-hover ">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>主题：</th>
                                    <th>作者</th>
                                    <th>应用行业：</th>
                                    <th>用途：</th>
                                </tr>
                            </thead>
                            <tbody id="AppCaseTable"></tbody>
                        </table>
                    </div>
                </div>
                @*使用说明*@
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>使用说明</h5>
                    </div>
                    <div class="ibox-content">
                        <table class="table table-responsive table-striped table-bordered table-hover ">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>主题：</th>
                                    <th>作者</th>
                                    <th>应用行业：</th>
                                    <th>用途：</th>
                                </tr>
                            </thead>
                            <tbody id="InstructionTable"></tbody>
                        </table>
                    </div>
                </div>
                @*商品服务*@
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>商品服务</h5>
                    </div>
                    <div class="ibox-content">
                        <table class="table table-responsive table-striped table-bordered table-hover ">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>名字</th>
                                    <th>类型</th>
                                    <th>编号</th>
                                    <th>价格</th>
                                    <th>描述</th>
                                </tr>
                            </thead>
                            <tbody id="ServiceGoods"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var app = angular.module('myApp', []);
    app.controller('validateCtrl', function ($scope, $http) {
        var id = window.location.search;
        id = id.substring(id.indexOf('=') + 1);
        //产品信息
        if (id != "") {
            $http({
                method: 'POST',
                url: '@Url.Action("FindProductById")',
                data: { "Id": id }
            }).then(function successCallback(response) {
                // 请求成功执行代码
                $("#ProductName").text(response.data.ProductName);
                $("#ProductCode").text(response.data.ProductCode);
                $("#SearchPrimaryKey").text(response.data.SearchPrimaryKey);
                $("#Brand").text(response.data.BrandName);
                $("#ProductType").text(response.data.ProductTypeName);
                $("#SalerMinPrice").text(response.data.SalerMinPrice);
                $("#SalerBasicPrice").text(response.data.SalerBasicPrice);
                $("#ProductDescription").text(response.data.ProductDescription);
                $("#IsEffectMinPrice").text(response.data.IsEffectMinPrice == true ? "是" : "否");
                $("#IsEnableMinPriceWarning").text(response.data.IsEnableMinPriceWarning == true ? "是" : "否");
            }, function errorCallback(response) {
                // 请求失败执行代码
            });
        }
        //规格类型：规格参数
        $http({
            method: 'POST',
            url: '@Url.Action("FindProductById")',
            data: { "Id": id }
        }).then(function successCallback(response) {
            //请求成功执行代码
            $("#SpecType").text(response.data.DiplaySpecType);
            $("#SpecParameter").text(response.data.SpecParameterTemplate);
        }, function errorCallback(response) {
            //请求失败执行代码
        });

        //商品
        $http({
            method: 'POST',
            url: '@Url.Action("FindProductGoodsByProduct")',
            data: { "Id": id }
        }).then(function successCallback(response) {
            //请求成功执行代码
            $.each(response.data, function (index, v) {
                var td = $('<tr><td>' + v.GoodsName + '</td><td>'
                                     + v.ProductName + '</td><td>'
                                     + v.SpecParameterS + '</td><td>'
                                     + (v.IsAvailable == true ? "是" : "否") + '</td><td>'
                                     + (v.IsDefaultGoods == true ? "是" : "否") + '</td><td>'
                                     + v.GoodsCode + '</td><td>' + v.GoodsAlias + '</td><td>'
                                     + v.SalePrice + '</td><td>'
                                     + v.Weight + '</td></tr>');
                $("#ProductGoods").append(td);
            });
        }, function errorCallback(response) {
            //请求失败执行代码
        });

        //应用案例
        $http({
            method: 'POST',
            url: '@Url.Action("FindAppCaseByProductId")',
            data: { "productId": id }
        }).then(function successCallback(response) {
            // 请求成功执行代码
            var num = 1;
            $.each(response.data, function (index, v) {
                var td = $("<tr id='" + v.Id + "' data-name='Edit'><td>"
                    + num + "</td><td>" + v.Subject + "</td><td>" + v.Author +
                    "</td><td>" + v.AppIndustry + "</td><td>" + v.Usage +
                    "</td></tr>");
                $("#AppCaseTable").append(td);
                num++;
            })
        }, function errorCallback(response) {
            // 请求失败执行代码
        });

        //使用说明加载
        $http({
            method: 'POST',
            url: '@Url.Action("FindInstructionByProductId")',
            data: { "productId": id }
        }).then(function successCallback(response) {
            // 请求成功执行代码
            var num = 1;
            $.each(response.data, function (index, v) {
                var td = $("<tr id='" + v.Id + "'><td>" + num +
                    "</td><td>" + v.Subject + "</td><td>" + v.Author +
                    "</td><td>" + v.AppIndustry + "</td><td>" + v.Usage +
                    "</td></tr>");
                $("#InstructionTable").append(td);
                num++;
            })
        }, function errorCallback(response) {
            // 请求失败执行代码
        });

        //服务商品加载
        $http({
            method: 'POST',
            url: '@Url.Action("FindServiceGoodsByProductId")',
            data: { "Id": id }
        }).then(function successCallback(response) {
            // 请求成功执行代码
            //添加后显示
            var num = 1;
            $.each(response.data, function (index, v) {
                var td = $("<tr><td>" + num + "</td><td>" + v.GoodsName +
                    "</td><td>" + v.GoodsTypeNames +
                    "</td><td>" + v.GoodsCode + "</td><td>" + v.SalePrice +
                    "</td><td>" + v.GoodsDesription +
                        "</td></tr>");
                $("#ServiceGoods").append(td);
                num++;
            })
        }, function errorCallback(response) {
            // 请求失败执行代码
        });
    });
</script>
